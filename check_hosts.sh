#!/bin/bash
#
# This script filters a list of domains from an input file, resolving each domain to its IP address(es)
# and checking if any of the resolved IP addresses fall within predefined CIDR ranges for Google,
# Cloudflare, and Amazon. If a domain resolves to an IP within these ranges, it is considered a
# "filtered domain" and is written to an output file.
#
# Copyright (C) 2025            spirillen
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU Affero General Public License as
# published by the Free Software Foundation, either version 3 of the
# License, or (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Affero General Public License for more details.
#
# You should have received a copy of the GNU Affero General Public License
# along with this program.  If not, see <https://www.gnu.org/licenses/>.

# Default values for source and output file
default_source="instance.txt"
default_output="filtered_domains.txt"

# Function to display usage
usage() {
    echo "Usage: $0 [-i input_file] [-o output_file] [-u]"
    echo "  -i   Input file containing domain list (default: $default_source)"
    echo "  -o   Output file for filtered domains (default: $default_output)"
    echo "  -u   Update CIDR ranges for providers"
    exit 1
}

# Parse command-line arguments
while getopts "i:o:u" opt; do
    case $opt in
    i) source_file="$OPTARG" ;;
    o) output_file="$OPTARG" ;;
    u) update_cidr=true ;;
    *) usage ;;
    esac
done

# Set defaults if arguments are not provided
source_file="${source_file:-$default_source}"
output_file="${output_file:-$default_output}"

# Check if source file exists
if [[ ! -f "$source_file" ]]; then
    echo "Error: Source file '$source_file' does not exist."
    exit 1
fi

# Clear the output file if it exists
>"$output_file"

# Function to check if an IP is in a given CIDR range
ip_in_cidr() {
    local ip="$1"
    local cidr="$2"

    # Precompute and cache results for efficiency
    local cidr_base cidr_mask ip_dec cidr_base_dec mask network_dec ip_network_dec
    cidr_base="${cidr%/*}"
    cidr_mask="${cidr#*/}"

    # Convert IP and CIDR base to decimal
    ip_dec=$(ip_to_dec "$ip")
    [[ $? -ne 0 ]] && return 1

    cidr_base_dec=$(ip_to_dec "$cidr_base")
    [[ $? -ne 0 ]] && return 1

    mask=$(((1 << (32 - cidr_mask)) - 1))
    network_dec=$((cidr_base_dec & ~mask))
    ip_network_dec=$((ip_dec & ~mask))

    [[ "$ip_network_dec" -eq "$network_dec" ]]
}

# Function to convert IP to decimal
ip_to_dec() {
    local ip="$1"

    # Validate the IP address format (IPv4 only)
    if [[ ! "$ip" =~ ^([0-9]{1,3}\.){3}[0-9]{1,3}$ ]]; then
        echo "Error: Invalid IP address format '$ip'" >&2
        return 1
    fi

    local a b c d
    IFS=. read -r a b c d <<<"$ip"
    echo $(((a << 24) + (b << 16) + (c << 8) + d))
}

# Recursive function to resolve CNAME to IP
resolve_to_ip() {
    local domain="$1"
    local resolved_ips

    # Use dig to get A or CNAME records
    resolved_ips=$(dig -4 +short -t A "$domain" 2>/dev/null)
    if [[ $? -ne 0 || -z "$resolved_ips" ]]; then
        echo "Warning: Unable to resolve domain '$domain'" >&2
        return
    fi

    # Loop through the results to check if they are IPs or CNAMEs
    for record in $resolved_ips; do
        if [[ "$record" =~ ^([0-9]{1,3}\.){3}[0-9]{1,3}$ ]]; then
            # If it's an IP, print it
            echo "$record"
        else
            # If it's a CNAME, resolve it recursively
            resolve_to_ip "$record"
        fi
    done
}

# Function to update CIDR ranges for providers
update_cidr_ranges() {
    echo "Updating CIDR ranges..."
    # Amazon
    amazon_cidrs=$(curl -x socks5h://127.0.0.1:9050 -s https://ip-ranges.amazonaws.com/ip-ranges.json | jq -r '.prefixes[] | select((.service | test("^CLOUDFRONT"; "i")) or (.service | test("^EC2"; "i")) or .service == "S3") | .ip_prefix' | sort -u | tr '\n' ' ')
    # Cloudflare
    cloudflare_cidrs=$(curl -x socks5h://127.0.0.1:9050 -s https://www.cloudflare.com/ips-v4 | tr '\n' ' ')
    # Google
    google_cidrs=$(curl -x socks5h://127.0.0.1:9050 -s https://www.gstatic.com/ipranges/cloud.json | jq -r '.prefixes[] | .ipv4Prefix' | grep -v 'null' | sort -u | tr '\n' ' ')

    providers["google"]="$google_cidrs"
    providers["cloudflare"]="$cloudflare_cidrs"
    providers["amazon"]="$amazon_cidrs"
    echo "CIDR ranges updated."
}

# Define CIDR ranges for Google, Cloudflare, and Amazon
declare -A providers
providers=(
    ["google"]="35.191.0.0/16 104.154.113.0/24 104.154.114.0/23 104.154.116.0/22 104.154.120.0/23 104.154.128.0/17 104.154.16.0/20 104.154.32.0/19 104.154.64.0/19 104.154.96.0/20 104.155.0.0/17 104.155.128.0/18 104.155.192.0/19 104.155.224.0/20 104.196.0.0/18 104.196.128.0/18 104.196.192.0/19 104.196.224.0/19 104.196.65.0/24 104.196.66.0/23 104.196.68.0/22 104.196.96.0/19 104.197.0.0/16 104.198.0.0/20 104.198.112.0/20 104.198.128.0/17 104.198.16.0/20 104.198.32.0/19 104.198.64.0/20 104.198.80.0/20 104.198.96.0/20 104.199.0.0/18 104.199.112.0/20 104.199.128.0/18 104.199.192.0/19 104.199.224.0/20 104.199.242.0/23 104.199.244.0/22 104.199.248.0/21 104.199.66.0/23 104.199.68.0/22 104.199.72.0/21 104.199.80.0/20 104.199.96.0/20 107.167.160.0/20 107.167.176.0/20 107.178.208.0/20 107.178.240.0/20 108.59.80.0/21 108.59.88.0/21 130.211.112.0/20 130.211.128.0/18 130.211.16.0/20 130.211.192.0/19 130.211.224.0/20 130.211.240.0/20 130.211.32.0/20 130.211.4.0/22 130.211.48.0/20 130.211.64.0/19 130.211.8.0/21 130.211.96.0/20 146.148.112.0/20 146.148.16.0/20 146.148.2.0/23 146.148.32.0/19 146.148.4.0/22 146.148.64.0/19 146.148.8.0/21 146.148.96.0/20 162.216.148.0/22 162.222.176.0/21 173.255.112.0/21 173.255.120.0/21 192.158.28.0/22 199.192.115.0/24 199.223.232.0/22 199.223.236.0/24 23.236.48.0/20 23.251.128.0/20 23.251.144.0/20 34.0.0.0/20 34.0.128.0/19 34.0.16.0/20 34.0.160.0/19 34.0.192.0/19 34.0.224.0/24 34.0.225.0/24 34.0.226.0/24 34.0.227.0/24 34.0.240.0/20 34.0.32.0/20 34.0.48.0/20 34.0.64.0/19 34.0.96.0/19 34.1.0.0/20 34.1.128.0/20 34.1.144.0/20 34.1.16.0/20 34.1.160.0/20 34.1.176.0/20 34.1.192.0/20 34.1.208.0/20 34.1.224.0/19 34.1.32.0/20 34.1.48.0/20 34.10.0.0/16 34.100.128.0/17 34.101.128.0/17 34.101.18.0/24 34.101.20.0/22 34.101.24.0/22 34.101.32.0/19 34.101.64.0/18 34.102.0.0/17 34.102.128.0/17 34.104.104.0/23 34.104.106.0/23 34.104.108.0/23 34.104.110.0/23 34.104.112.0/23 34.104.114.0/23 34.104.116.0/22 34.104.120.0/23 34.104.122.0/23 34.104.124.0/23 34.104.126.0/23 34.104.128.0/17 34.104.27.0/24 34.104.49.0/24 34.104.50.0/23 34.104.52.0/24 34.104.56.0/23 34.104.58.0/23 34.104.60.0/23 34.104.62.0/23 34.104.64.0/21 34.104.72.0/22 34.104.76.0/22 34.104.80.0/21 34.104.88.0/21 34.104.96.0/21 34.105.0.0/17 34.105.128.0/17 34.106.0.0/16 34.107.0.0/17 34.107.128.0/17 34.108.0.0/16 34.11.0.0/17 34.11.128.0/17 34.110.128.0/17 34.111.0.0/16 34.112.0.0/16 34.116.0.0/21 34.116.128.0/17 34.116.64.0/18 34.117.0.0/16 34.118.0.0/17 34.118.128.0/18 34.118.192.0/21 34.118.200.0/21 34.118.240.0/22 34.118.244.0/22 34.118.248.0/23 34.118.250.0/23 34.118.252.0/23 34.118.254.0/23 34.12.0.0/16 34.120.0.0/16 34.121.0.0/16 34.122.0.0/15 34.124.0.0/21 34.124.112.0/20 34.124.12.0/22 34.124.128.0/17 34.124.16.0/21 34.124.24.0/21 34.124.32.0/21 34.124.40.0/23 34.124.42.0/23 34.124.44.0/23 34.124.46.0/23 34.124.48.0/23 34.124.50.0/23 34.124.52.0/22 34.124.56.0/23 34.124.58.0/23 34.124.60.0/23 34.124.62.0/23 34.124.8.0/22 34.125.0.0/16 34.126.128.0/18 34.126.192.0/20 34.126.208.0/20 34.126.64.0/18 34.127.0.0/17 34.127.177.0/24 34.127.178.0/23 34.127.180.0/24 34.127.184.0/23 34.127.186.0/23 34.127.188.0/23 34.127.190.0/23 34.128.128.0/18 34.128.32.0/22 34.128.36.0/24 34.128.37.0/24 34.128.42.0/23 34.128.44.0/23 34.128.46.0/23 34.128.48.0/24 34.128.49.0/24 34.128.52.0/22 34.128.58.0/23 34.128.60.0/23 34.128.62.0/23 34.128.64.0/18 34.129.0.0/16 34.13.0.0/18 34.13.112.0/20 34.13.128.0/17 34.13.68.0/22 34.13.72.0/21 34.130.0.0/16 34.131.0.0/16 34.132.0.0/14 34.136.0.0/16 34.137.0.0/16 34.138.0.0/15 34.14.0.0/17 34.14.128.0/18 34.140.0.0/16 34.141.0.0/17 34.141.128.0/17 34.142.0.0/17 34.142.128.0/17 34.143.128.0/17 34.144.192.0/18 34.145.0.0/17 34.145.128.0/17 34.146.0.0/16 34.147.0.0/17 34.147.128.0/17 34.148.0.0/16 34.149.0.0/16 34.150.0.0/17 34.150.128.0/17 34.151.0.0/18 34.151.128.0/18 34.151.192.0/18 34.151.64.0/18 34.152.0.0/18 34.152.100.0/24 34.152.101.0/24 34.152.102.0/24 34.152.103.0/24 34.152.104.0/23 34.152.106.0/23 34.152.110.0/25 34.152.111.0/24 34.152.64.0/22 34.152.68.0/24 34.152.69.0/24 34.152.72.0/21 34.152.80.0/23 34.152.84.0/23 34.152.86.0/23 34.152.96.0/24 34.152.97.0/25 34.152.97.128/25 34.152.98.0/25 34.152.98.128/25 34.153.128.0/18 34.153.224.0/24 34.153.225.0/24 34.153.230.0/24 34.153.232.0/23 34.153.234.0/23 34.153.236.0/24 34.153.237.0/24 34.153.238.0/23 34.153.240.0/21 34.153.250.0/23 34.153.252.0/25 34.153.252.128/25 34.153.253.0/24 34.153.254.0/23 34.153.32.0/24 34.153.33.0/24 34.153.38.0/24 34.153.40.0/23 34.153.42.0/23 34.153.44.0/24 34.153.45.0/24 34.153.46.0/23 34.153.48.0/21 34.153.58.0/23 34.153.62.0/25 34.153.62.128/25 34.153.63.0/24 34.154.0.0/16 34.155.0.0/16 34.157.0.0/21 34.157.112.0/21 34.157.12.0/22 34.157.121.0/24 34.157.124.0/23 34.157.126.0/23 34.157.128.0/21 34.157.136.0/23 34.157.140.0/22 34.157.144.0/20 34.157.16.0/20 34.157.160.0/22 34.157.164.0/22 34.157.168.0/22 34.157.172.0/23 34.157.174.0/23 34.157.176.0/20 34.157.192.0/20 34.157.208.0/23 34.157.210.0/23 34.157.212.0/23 34.157.215.0/24 34.157.216.0/23 34.157.220.0/22 34.157.224.0/20 34.157.240.0/21 34.157.249.0/24 34.157.250.0/23 34.157.252.0/23 34.157.254.0/24 34.157.255.0/24 34.157.32.0/22 34.157.36.0/22 34.157.40.0/22 34.157.44.0/23 34.157.46.0/23 34.157.48.0/20 34.157.64.0/20 34.157.8.0/23 34.157.80.0/23 34.157.82.0/23 34.157.84.0/23 34.157.87.0/24 34.157.88.0/23 34.157.90.0/23 34.157.92.0/22 34.157.96.0/20 34.159.0.0/16 34.16.0.0/17 34.16.128.0/17 34.160.0.0/16 34.161.0.0/16 34.162.0.0/16 34.163.0.0/16 34.164.0.0/16 34.165.0.0/16 34.166.0.0/16 34.168.0.0/15 34.17.0.0/16 34.170.0.0/15 34.172.0.0/15 34.174.0.0/16 34.175.0.0/16 34.176.0.0/16 34.177.32.0/22 34.177.36.0/23 34.177.40.0/21 34.177.48.0/23 34.177.50.0/23 34.177.52.0/22 34.177.64.0/24 34.177.65.0/25 34.177.65.128/25 34.177.66.0/25 34.177.66.128/25 34.177.68.0/24 34.177.69.0/24 34.177.70.0/24 34.177.71.0/24 34.177.72.0/23 34.177.74.0/23 34.177.78.0/25 34.177.79.0/24 34.179.0.0/16 34.18.0.0/16 34.181.0.0/17 34.181.128.0/17 34.182.0.0/17 34.182.128.0/17 34.183.0.0/24 34.183.1.0/24 34.183.12.0/22 34.183.16.0/22 34.183.2.0/24 34.183.3.0/25 34.183.4.0/23 34.183.8.0/23 34.184.0.0/24 34.184.1.0/24 34.184.12.0/22 34.184.16.0/22 34.184.2.0/24 34.184.3.0/25 34.184.4.0/23 34.184.8.0/23 34.19.0.0/17 34.19.128.0/17 34.2.0.0/20 34.2.128.0/17 34.2.16.0/20 34.2.32.0/20 34.2.48.0/20 34.2.76.0/23 34.20.0.0/17 34.20.128.0/17 34.21.0.0/17 34.21.128.0/17 34.22.0.0/19 34.22.112.0/20 34.22.128.0/17 34.22.32.0/19 34.22.64.0/19 34.22.96.0/20 34.23.0.0/16 34.24.0.0/15 34.26.0.0/16 34.27.0.0/16 34.28.0.0/14 34.3.80.0/20 34.32.0.0/17 34.32.128.0/17 34.33.0.0/16 34.34.0.0/17 34.34.128.0/18 34.34.216.0/21 34.35.0.0/16 34.36.0.0/16 34.37.0.0/16 34.38.0.0/16 34.39.0.0/17 34.39.128.0/17 34.40.0.0/17 34.40.128.0/17 34.41.0.0/16 34.42.0.0/16 34.44.0.0/15 34.46.0.0/16 34.47.0.0/18 34.47.128.0/17 34.47.64.0/18 34.48.0.0/16 34.49.0.0/16 34.50.0.0/18 34.50.160.0/19 34.50.192.0/18 34.50.64.0/18 34.51.0.0/17 34.51.128.0/17 34.52.128.0/17 34.53.0.0/17 34.53.128.0/17 34.54.0.0/16 34.55.0.0/16 34.56.0.0/14 34.60.0.0/15 34.62.0.0/16 34.63.0.0/16 34.64.128.0/22 34.64.132.0/22 34.64.136.0/21 34.64.144.0/20 34.64.160.0/19 34.64.192.0/18 34.64.32.0/19 34.64.64.0/22 34.64.68.0/22 34.64.72.0/21 34.64.80.0/20 34.64.96.0/19 34.65.0.0/16 34.66.0.0/15 34.68.0.0/14 34.72.0.0/16 34.73.0.0/16 34.74.0.0/15 34.76.0.0/14 34.8.0.0/16 34.80.0.0/15 34.82.0.0/15 34.84.0.0/16 34.85.0.0/17 34.85.128.0/17 34.86.0.0/16 34.87.0.0/17 34.87.128.0/18 34.87.192.0/18 34.88.0.0/16 34.89.0.0/17 34.89.128.0/17 34.9.0.0/16 34.90.0.0/15 34.92.0.0/16 34.93.0.0/16 34.94.0.0/16 34.95.0.0/18 34.95.128.0/17 34.95.64.0/18 34.96.128.0/17 34.96.64.0/18 34.97.0.0/16 34.98.128.0/21 34.98.64.0/18 35.184.0.0/16 35.185.0.0/17 35.185.128.0/19 35.185.160.0/20 35.185.176.0/20 35.185.192.0/18 35.186.0.0/17 35.186.128.0/20 35.186.144.0/20 35.186.160.0/19 35.186.192.0/18 35.187.0.0/17 35.187.144.0/20 35.187.160.0/19 35.187.192.0/19 35.187.224.0/19 35.188.0.0/17 35.188.128.0/18 35.188.192.0/19 35.188.224.0/19 35.189.0.0/18 35.189.128.0/19 35.189.160.0/19 35.189.192.0/18 35.189.64.0/18 35.190.0.0/18 35.190.112.0/20 35.190.128.0/18 35.190.192.0/19 35.190.224.0/20 35.190.64.0/19 35.192.0.0/15 35.194.0.0/18 35.194.128.0/17 35.194.64.0/19 35.194.96.0/19 35.195.0.0/16 35.196.0.0/16 35.197.0.0/17 35.197.128.0/19 35.197.160.0/19 35.197.192.0/18 35.198.0.0/18 35.198.128.0/18 35.198.192.0/18 35.198.64.0/18 35.199.0.0/18 35.199.144.0/20 35.199.160.0/19 35.199.64.0/18 35.200.0.0/17 35.200.128.0/17 35.201.0.0/19 35.201.128.0/17 35.201.41.0/24 35.201.64.0/18 35.202.0.0/16 35.203.0.0/17 35.203.128.0/18 35.203.210.0/23 35.203.212.0/22 35.203.216.0/22 35.203.232.0/21 35.204.0.0/16 35.205.0.0/16 35.206.10.0/23 35.206.128.0/18 35.206.192.0/18 35.206.32.0/19 35.206.64.0/18 35.207.0.0/18 35.207.128.0/18 35.207.192.0/18 35.207.64.0/18 35.208.0.0/15 35.210.0.0/16 35.211.0.0/16 35.212.0.0/17 35.212.128.0/17 35.213.0.0/17 35.213.128.0/18 35.213.192.0/18 35.214.0.0/17 35.214.128.0/17 35.215.0.0/18 35.215.128.0/18 35.215.192.0/18 35.215.64.0/18 35.216.0.0/17 35.216.128.0/17 35.217.0.0/18 35.217.128.0/17 35.217.64.0/18 35.219.0.0/17 35.219.128.0/18 35.219.224.0/19 35.220.0.0/20 35.220.128.0/17 35.220.16.0/23 35.220.18.0/23 35.220.20.0/22 35.220.24.0/23 35.220.26.0/24 35.220.27.0/24 35.220.31.0/24 35.220.32.0/21 35.220.40.0/24 35.220.41.0/24 35.220.42.0/24 35.220.43.0/24 35.220.44.0/24 35.220.45.0/24 35.220.46.0/24 35.220.47.0/24 35.220.48.0/21 35.220.56.0/22 35.220.60.0/22 35.220.64.0/19 35.220.96.0/19 35.221.0.0/18 35.221.128.0/17 35.221.64.0/18 35.222.0.0/15 35.224.0.0/15 35.226.0.0/16 35.227.0.0/17 35.227.128.0/18 35.227.192.0/18 35.228.0.0/16 35.229.128.0/17 35.229.16.0/20 35.229.32.0/19 35.229.64.0/18 35.230.0.0/17 35.230.128.0/19 35.230.160.0/19 35.230.240.0/20 35.231.0.0/16 35.232.0.0/16 35.233.0.0/17 35.233.128.0/17 35.234.0.0/18 35.234.128.0/19 35.234.160.0/20 35.234.176.0/20 35.234.192.0/20 35.234.208.0/20 35.234.224.0/20 35.234.240.0/20 35.234.64.0/18 35.235.0.0/20 35.235.16.0/20 35.235.216.0/21 35.235.32.0/20 35.235.48.0/20 35.235.64.0/18 35.236.0.0/17 35.236.128.0/18 35.236.192.0/18 35.237.0.0/16 35.238.0.0/15 35.240.0.0/17 35.240.128.0/17 35.241.0.0/18 35.241.128.0/17 35.241.64.0/18 35.242.0.0/20 35.242.128.0/18 35.242.16.0/23 35.242.18.0/23 35.242.192.0/18 35.242.20.0/22 35.242.24.0/23 35.242.26.0/24 35.242.27.0/24 35.242.31.0/24 35.242.32.0/21 35.242.40.0/24 35.242.41.0/24 35.242.42.0/24 35.242.43.0/24 35.242.44.0/24 35.242.45.0/24 35.242.46.0/24 35.242.47.0/24 35.242.48.0/21 35.242.56.0/22 35.242.60.0/22 35.242.64.0/19 35.242.96.0/19 35.243.0.0/21 35.243.128.0/17 35.243.32.0/21 35.243.40.0/21 35.243.56.0/21 35.243.64.0/18 35.243.8.0/21 35.244.0.0/18 35.244.128.0/17 35.244.64.0/18 35.245.0.0/16 35.246.0.0/17 35.246.128.0/17 35.247.0.0/17 35.247.128.0/18 35.247.192.0/18 8.34.208.0/23 8.34.210.0/24 8.34.211.0/24 8.34.212.0/22 8.34.216.0/22 8.34.220.0/22 8.35.192.0/21 "                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                # Add more Google ranges as needed
    ["cloudflare"]="173.245.48.0/20 103.21.244.0/22 103.22.200.0/22 103.31.4.0/22 141.101.64.0/18 108.162.192.0/18 190.93.240.0/20 188.114.96.0/20 197.234.240.0/22 198.41.128.0/17 162.158.0.0/15 104.16.0.0/13 104.24.0.0/14 172.64.0.0/13 131.0.72.0/22"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              # Add more Cloudflare ranges as needed
    ["amazon"]="52.0.0.0/8 76.223.18.0/24 100.20.0.0/14 100.24.0.0/13 103.4.8.0/21 107.176.0.0/15 107.20.0.0/14 108.128.0.0/13 108.136.0.0/15 108.136.154.16/28 108.136.154.32/28 108.136.154.48/28 108.138.0.0/15 108.156.0.0/14 108.175.48.0/22 108.175.52.0/22 108.175.56.0/22 108.175.60.0/22 111.13.171.128/26 111.13.171.192/26 111.13.185.32/27 111.13.185.64/27 116.129.226.0/25 116.129.226.128/26 118.193.97.128/25 118.193.97.64/26 119.147.182.0/25 119.147.182.128/26 120.232.236.0/25 120.232.236.128/26 120.253.240.192/26 120.253.241.160/27 120.253.245.128/26 120.253.245.192/27 120.52.12.64/26 120.52.153.192/26 120.52.22.96/27 120.52.39.128/27 122.248.192.0/18 13.112.0.0/14 13.113.196.64/26 13.113.203.0/24 13.124.0.0/16 13.124.199.0/24 13.125.0.0/16 13.126.0.0/15 13.128.0.0/16 13.130.0.0/16 13.134.0.0/15 13.134.24.0/23 13.144.0.0/16 13.146.0.0/16 13.152.0.0/16 13.154.0.0/16 13.158.0.0/15 13.160.0.0/16 13.192.0.0/16 13.200.0.0/15 13.202.0.0/15 13.203.133.0/26 13.204.0.0/14 13.208.0.0/16 13.209.0.0/16 13.209.1.56/29 13.210.0.0/15 13.210.67.128/26 13.212.0.0/15 13.213.20.144/28 13.213.20.160/28 13.214.0.0/15 13.216.0.0/13 13.224.0.0/14 13.228.0.0/15 13.228.69.0/24 13.230.0.0/15 13.232.0.0/14 13.233.177.0/29 13.233.177.192/26 13.236.0.0/14 13.239.158.0/29 13.244.0.0/15 13.244.121.196/30 13.245.93.176/28 13.245.93.192/28 13.246.0.0/16 13.247.0.0/16 13.248.224.0/24 13.248.225.0/24 13.248.226.0/24 13.248.227.0/24 13.248.228.0/24 13.248.229.0/24 13.248.230.0/24 13.248.231.0/24 13.248.232.0/24 13.248.233.0/24 13.249.0.0/16 13.250.0.0/15 13.32.0.0/15 13.35.0.0/16 13.36.0.0/14 13.36.84.48/28 13.36.84.64/28 13.40.0.0/14 13.48.0.0/15 13.48.4.200/30 13.50.0.0/16 13.51.0.0/16 13.51.71.176/28 13.51.71.192/28 13.52.0.0/16 13.52.6.112/29 13.53.0.0/16 13.54.0.0/15 13.54.63.128/26 13.56.0.0/16 13.57.0.0/16 13.58.0.0/15 13.59.250.0/26 13.60.0.0/15 13.62.0.0/15 130.176.0.0/17 130.176.0.0/18 130.176.128.0/18 130.176.128.0/21 130.176.136.0/23 130.176.140.0/22 130.176.144.0/20 130.176.160.0/19 130.176.192.0/19 130.176.224.0/20 130.176.64.0/21 130.176.72.0/22 130.176.76.0/24 130.176.78.0/23 130.176.80.0/22 130.176.86.0/23 130.176.88.0/21 130.176.96.0/19 136.18.0.0/23 136.18.128.0/23 136.18.130.0/23 136.18.132.0/23 136.18.134.0/23 136.18.136.0/23 136.18.138.0/23 136.18.140.0/23 136.18.142.0/23 136.18.144.0/21 136.18.152.0/21 136.18.254.0/23 136.18.50.0/23 139.56.16.0/23 139.56.18.0/23 139.56.20.0/23 139.56.22.0/23 139.56.24.0/23 139.56.26.0/23 139.56.28.0/23 139.56.30.0/23 139.56.32.0/23 139.56.34.0/24 140.179.0.0/16 140.179.36.208/28 140.179.36.224/28 140.179.36.240/28 142.4.177.0/24 142.4.178.0/24 142.4.179.0/24 142.4.180.0/24 143.204.0.0/16 144.220.0.0/16 15.103.0.0/16 15.128.0.0/16 15.145.0.0/23 15.145.12.0/22 15.145.16.0/22 15.145.2.0/23 15.145.20.0/22 15.145.24.0/23 15.145.4.0/23 15.145.8.0/22 15.152.0.0/16 15.152.133.112/28 15.152.133.128/28 15.156.0.0/15 15.158.0.0/16 15.160.0.0/16 15.161.0.0/16 15.161.135.164/30 15.164.0.0/15 15.168.0.0/16 15.168.105.160/29 15.177.0.0/18 15.177.100.0/24 15.177.102.0/24 15.177.103.0/24 15.177.104.0/24 15.177.105.0/24 15.177.106.0/24 15.177.64.0/23 15.177.66.0/23 15.177.68.0/23 15.177.70.0/23 15.177.72.0/24 15.177.73.0/24 15.177.74.0/24 15.177.75.0/24 15.177.76.0/24 15.177.77.0/24 15.177.78.0/24 15.177.79.0/24 15.177.80.0/24 15.177.81.0/24 15.177.82.0/24 15.177.83.0/24 15.177.84.0/24 15.177.85.0/24 15.177.86.0/24 15.177.87.0/24 15.177.88.0/24 15.177.89.0/24 15.177.90.0/24 15.177.91.0/24 15.177.92.0/24 15.177.93.0/24 15.177.94.0/24 15.177.95.0/24 15.177.96.0/24 15.177.97.0/24 15.177.98.0/24 15.177.99.0/24 15.181.0.0/20 15.181.112.0/22 15.181.116.0/22 15.181.120.0/21 15.181.128.0/20 15.181.144.0/20 15.181.16.0/20 15.181.160.0/20 15.181.176.0/20 15.181.192.0/19 15.181.224.0/21 15.181.232.0/21 15.181.240.0/24 15.181.241.0/24 15.181.242.0/24 15.181.243.0/24 15.181.244.0/24 15.181.245.0/24 15.181.246.0/24 15.181.247.0/24 15.181.248.0/24 15.181.249.0/24 15.181.250.0/24 15.181.251.0/24 15.181.252.0/24 15.181.253.0/24 15.181.254.0/24 15.181.32.0/21 15.181.40.0/21 15.181.48.0/20 15.181.64.0/20 15.181.80.0/20 15.181.96.0/20 15.184.0.0/16 15.184.125.240/28 15.184.153.0/28 15.185.0.0/16 15.188.0.0/16 15.188.184.0/24 15.193.0.0/24 15.193.1.0/24 15.193.10.0/24 15.193.11.0/24 15.193.128.0/22 15.193.132.0/22 15.193.136.0/22 15.193.140.0/22 15.193.144.0/22 15.193.148.0/22 15.193.152.0/22 15.193.156.0/22 15.193.160.0/22 15.193.164.0/22 15.193.168.0/22 15.193.172.0/22 15.193.176.0/22 15.193.2.0/24 15.193.3.0/24 15.193.4.0/24 15.193.5.0/24 15.193.6.0/24 15.193.7.0/24 15.193.8.0/24 15.193.9.0/24 15.200.0.0/16 15.200.176.128/28 15.200.28.240/28 15.200.28.80/30 15.205.0.0/16 15.206.0.0/15 15.207.13.128/25 15.207.213.128/25 15.220.0.0/20 15.220.112.0/21 15.220.120.0/21 15.220.128.0/21 15.220.136.0/21 15.220.144.0/23 15.220.146.0/23 15.220.148.0/22 15.220.152.0/21 15.220.16.0/20 15.220.160.0/21 15.220.168.0/21 15.220.176.0/21 15.220.184.0/21 15.220.192.0/22 15.220.196.0/22 15.220.200.0/23 15.220.202.0/23 15.220.204.0/24 15.220.205.0/24 15.220.206.0/24 15.220.207.0/24 15.220.208.128/26 15.220.216.0/22 15.220.220.0/23 15.220.222.0/23 15.220.224.0/23 15.220.226.0/24 15.220.227.0/24 15.220.228.0/22 15.220.232.0/24 15.220.233.0/24 15.220.234.0/23 15.220.236.0/22 15.220.240.0/21 15.220.248.0/23 15.220.250.0/23 15.220.252.0/22 15.220.32.0/21 15.220.40.0/22 15.220.48.0/21 15.220.56.0/21 15.220.64.0/20 15.220.80.0/20 15.222.0.0/15 15.228.0.0/15 15.228.107.0/28 15.228.107.16/28 15.236.0.0/15 15.253.0.0/16 15.254.0.0/16 151.148.32.0/24 151.148.33.0/24 151.148.34.0/24 151.148.35.0/24 151.148.36.0/24 151.148.37.0/24 151.148.38.0/24 151.148.39.0/24 151.148.40.0/24 151.148.41.0/24 155.146.0.0/20 155.146.112.0/20 155.146.128.0/20 155.146.144.0/20 155.146.16.0/20 155.146.160.0/20 155.146.176.0/20 155.146.192.0/20 155.146.208.0/20 155.146.224.0/20 155.146.240.0/20 155.146.32.0/20 155.146.48.0/20 155.146.64.0/20 155.146.80.0/20 155.146.96.0/20 157.175.0.0/16 157.241.0.0/16 158.252.0.0/15 159.248.200.0/21 159.248.216.0/21 159.248.224.0/21 159.248.232.0/21 159.248.240.0/21 16.12.0.0/23 16.12.10.0/23 16.12.12.0/23 16.12.14.0/24 16.12.15.0/24 16.12.16.0/23 16.12.18.0/23 16.12.2.0/24 16.12.20.0/24 16.12.21.0/24 16.12.24.0/21 16.12.32.0/22 16.12.36.0/22 16.12.4.0/23 16.12.40.0/23 16.12.42.0/23 16.12.44.0/24 16.12.48.0/21 16.12.56.0/23 16.12.58.0/24 16.12.59.0/24 16.12.6.0/23 16.12.60.0/22 16.12.64.0/22 16.12.71.0/24 16.12.72.0/23 16.12.74.0/24 16.12.75.0/24 16.12.76.0/23 16.12.78.0/23 16.12.8.0/24 16.12.80.0/24 16.12.81.0/24 16.12.82.0/23 16.12.84.0/23 16.12.86.0/24 16.12.9.0/24 16.15.0.0/21 16.15.12.0/22 16.15.16.0/22 16.15.176.0/20 16.15.192.0/18 16.15.20.0/22 16.15.8.0/22 16.156.0.0/15 16.16.0.0/16 16.162.0.0/15 16.168.0.0/15 16.170.0.0/15 16.176.0.0/16 16.182.0.0/16 16.184.0.0/18 16.24.0.0/16 16.24.46.56/29 16.26.0.0/16 16.28.0.0/16 16.50.0.0/15 16.50.248.80/29 16.50.69.192/28 16.50.69.208/28 16.52.0.0/16 16.56.0.0/18 16.56.128.0/18 16.56.64.0/18 16.57.0.0/18 16.62.0.0/15 16.62.56.224/28 16.62.56.240/28 16.63.77.8/29 16.64.0.0/17 16.78.0.0/16 16.79.0.0/16 160.1.0.0/16 161.178.0.0/18 161.178.128.0/18 161.188.0.0/20 161.188.112.0/22 161.188.116.0/22 161.188.120.0/22 161.188.127.0/24 161.188.16.0/20 161.188.32.0/20 161.188.48.0/20 161.188.64.0/20 161.188.80.0/20 161.189.0.0/16 161.193.0.0/18 161.193.128.0/18 162.213.232.0/24 162.213.233.0/24 162.213.234.0/23 162.222.148.0/22 162.250.236.0/24 162.250.237.0/24 162.250.238.0/23 168.185.4.0/24 168.185.5.0/24 173.83.192.0/22 173.83.196.0/23 173.83.198.0/24 173.83.200.0/22 173.83.204.0/23 173.83.206.0/23 173.83.208.0/24 173.83.209.0/24 173.83.210.0/24 173.83.211.0/24 173.83.212.0/24 173.83.213.0/24 173.83.214.0/24 173.83.216.0/24 173.83.217.0/24 173.83.218.0/24 173.83.219.0/24 173.83.220.0/24 174.129.0.0/16 175.41.128.0/18 175.41.192.0/18 176.32.64.0/19 176.34.0.0/19 176.34.128.0/17 176.34.32.0/19 176.34.64.0/18 177.71.128.0/17 18.100.0.0/15 18.100.209.224/28 18.100.209.240/28 18.101.90.48/29 18.102.0.0/16 18.116.0.0/14 18.130.0.0/16 18.132.0.0/14 18.136.0.0/16 18.138.0.0/15 18.140.0.0/15 18.142.0.0/15 18.144.0.0/15 18.153.0.0/16 18.154.0.0/15 18.156.0.0/14 18.160.0.0/15 18.162.0.0/16 18.163.0.0/16 18.164.0.0/15 18.166.0.0/15 18.167.88.112/28 18.167.88.96/28 18.168.0.0/14 18.168.37.160/28 18.168.37.176/28 18.172.0.0/15 18.175.0.0/16 18.175.65.0/24 18.175.66.0/24 18.175.67.0/24 18.176.0.0/15 18.178.0.0/16 18.179.0.0/16 18.180.0.0/15 18.182.0.0/16 18.183.0.0/16 18.184.0.0/15 18.188.0.0/16 18.189.0.0/16 18.190.0.0/16 18.191.0.0/16 18.192.0.0/15 18.192.142.0/23 18.194.0.0/15 18.196.0.0/15 18.198.0.0/15 18.199.68.0/22 18.199.72.0/22 18.199.76.0/22 18.200.0.0/16 18.200.212.0/23 18.201.0.0/16 18.202.0.0/15 18.202.216.48/29 18.204.0.0/14 18.206.107.24/29 18.208.0.0/13 18.216.0.0/14 18.216.170.128/25 18.220.0.0/14 18.224.0.0/14 18.228.0.0/16 18.228.70.32/29 18.229.0.0/16 18.229.220.192/26 18.230.0.0/16 18.230.229.0/24 18.230.230.0/25 18.231.0.0/16 18.232.0.0/14 18.236.0.0/15 18.237.140.160/29 18.238.0.0/15 18.244.0.0/15 18.246.0.0/16 18.252.0.0/16 18.252.145.192/28 18.252.145.208/28 18.252.4.0/30 18.253.0.0/16 18.254.0.0/16 18.34.0.0/19 18.34.232.0/21 18.34.244.0/22 18.34.252.0/22 18.34.48.0/20 18.34.72.0/21 18.60.0.0/15 18.60.252.248/29 18.60.78.192/28 18.60.78.208/28 18.64.0.0/14 18.68.0.0/16 18.88.0.0/18 18.88.128.0/18 18.89.0.0/18 18.89.128.0/18 18.96.0.0/24 18.96.1.0/24 18.96.128.0/19 18.96.16.0/20 18.96.160.0/19 18.96.192.0/19 18.96.2.0/24 18.96.224.0/19 18.96.32.0/19 18.96.64.0/19 18.96.8.0/21 18.96.96.0/19 18.97.0.0/18 18.97.112.0/20 18.97.128.0/18 18.97.192.0/18 18.97.64.0/20 18.97.80.0/20 18.97.96.0/20 18.98.0.0/18 18.98.128.0/19 18.98.160.0/19 18.98.192.0/19 18.98.224.0/19 18.98.64.0/19 18.98.96.0/19 18.99.0.0/19 18.99.112.0/20 18.99.128.0/20 18.99.144.0/20 18.99.160.0/20 18.99.176.0/20 18.99.192.0/20 18.99.208.0/20 18.99.224.0/20 18.99.240.0/20 18.99.32.0/19 18.99.64.0/19 18.99.96.0/20 180.163.57.0/25 180.163.57.128/26 182.30.0.0/16 184.169.128.0/17 184.72.0.0/18 184.72.128.0/17 184.72.64.0/18 184.73.0.0/16 185.48.120.0/22 192.157.36.0/24 192.189.197.0/24 192.31.212.0/24 192.31.213.0/24 192.43.175.0/24 192.43.184.0/24 195.17.0.0/24 198.41.100.0/24 198.41.101.0/24 198.41.102.0/24 198.41.103.0/24 198.41.104.0/24 198.41.105.0/24 198.41.106.0/24 198.41.107.0/24 198.41.96.0/24 198.41.97.0/24 198.41.98.0/24 198.41.99.0/24 198.99.2.0/24 204.236.128.0/18 204.236.192.0/18 204.246.164.0/22 204.246.166.0/24 204.246.168.0/22 204.246.172.0/24 204.246.173.0/24 204.246.174.0/23 204.246.176.0/20 204.87.185.0/24 205.251.202.0/23 205.251.204.0/23 205.251.206.0/23 205.251.208.0/20 205.251.218.0/24 205.251.249.0/24 205.251.250.0/23 205.251.252.0/23 205.251.254.0/24 206.72.209.0/24 208.110.48.0/20 208.78.128.0/23 208.78.130.0/23 208.78.132.0/23 208.78.134.0/24 208.78.135.0/24 208.86.88.0/23 208.86.90.0/23 216.137.32.0/19 216.182.224.0/21 216.182.232.0/22 216.182.236.0/23 216.182.238.0/23 216.39.136.0/21 216.39.152.0/21 216.39.160.0/21 216.39.168.0/21 23.20.0.0/14 23.228.192.0/24 23.228.193.0/24 23.228.194.0/24 23.254.0.0/21 23.254.16.0/21 23.254.8.0/21 3.0.0.0/15 3.0.5.32/29 3.10.17.128/25 3.101.0.0/16 3.101.158.0/23 3.101.163.64/28 3.101.163.80/28 3.101.163.96/28 3.102.0.0/15 3.104.0.0/14 3.107.43.128/25 3.107.44.0/25 3.107.44.128/25 3.108.0.0/14 3.11.53.0/24 3.112.0.0/14 3.112.23.0/29 3.12.0.0/16 3.120.0.0/14 3.120.181.40/29 3.124.0.0/14 3.128.0.0/15 3.128.93.0/24 3.13.0.0/16 3.130.0.0/16 3.131.0.0/16 3.132.0.0/14 3.134.215.0/24 3.136.0.0/13 3.14.0.0/15 3.141.102.208/28 3.141.102.224/28 3.144.0.0/13 3.146.232.0/22 3.147.164.0/22 3.147.244.0/22 3.16.0.0/14 3.16.146.0/29 3.160.0.0/14 3.164.0.0/18 3.164.128.0/17 3.164.64.0/18 3.165.0.0/16 3.166.0.0/15 3.168.0.0/14 3.172.0.0/18 3.172.64.0/18 3.173.0.0/17 3.173.128.0/18 3.173.192.0/18 3.174.0.0/15 3.2.0.0/24 3.2.2.0/24 3.2.3.0/24 3.20.0.0/14 3.208.0.0/12 3.224.0.0/12 3.231.2.0/25 3.234.232.224/27 3.236.169.192/26 3.236.48.0/23 3.24.0.0/14 3.248.0.0/13 3.251.110.208/28 3.251.110.224/28 3.26.88.0/28 3.26.88.16/28 3.28.0.0/15 3.28.70.112/28 3.28.70.48/28 3.28.70.96/28 3.29.147.40/29 3.29.147.48/28 3.29.202.240/28 3.29.40.128/26 3.29.40.192/26 3.29.40.64/26 3.29.57.0/26 3.3.2.0/24 3.3.32.0/23 3.3.5.0/24 3.30.0.0/15 3.32.0.0/16 3.33.34.0/24 3.33.35.0/24 3.34.0.0/15 3.35.130.128/25 3.36.0.0/14 3.36.167.64/28 3.36.167.80/28 3.4.0.0/24 3.4.1.0/24 3.4.10.0/24 3.4.16.0/21 3.4.2.0/24 3.4.24.0/21 3.4.3.0/24 3.4.4.0/24 3.4.6.0/24 3.4.8.0/24 3.4.9.0/24 3.5.0.0/19 3.5.128.0/22 3.5.132.0/23 3.5.134.0/23 3.5.136.0/22 3.5.140.0/22 3.5.144.0/23 3.5.146.0/23 3.5.148.0/22 3.5.152.0/21 3.5.160.0/22 3.5.164.0/22 3.5.168.0/23 3.5.172.0/22 3.5.180.0/22 3.5.184.0/21 3.5.192.0/22 3.5.196.0/22 3.5.202.0/23 3.5.204.0/22 3.5.208.0/22 3.5.212.0/23 3.5.214.0/23 3.5.216.0/22 3.5.220.0/22 3.5.224.0/22 3.5.228.0/22 3.5.232.0/22 3.5.236.0/22 3.5.240.0/22 3.5.244.0/22 3.5.248.0/22 3.5.252.0/22 3.5.32.0/22 3.5.36.0/22 3.5.40.0/22 3.5.44.0/22 3.5.48.0/22 3.5.52.0/22 3.5.56.0/22 3.5.60.0/22 3.5.64.0/21 3.5.72.0/23 3.5.76.0/22 3.5.80.0/21 3.6.0.0/15 3.64.0.0/12 3.65.246.0/28 3.65.246.16/28 3.8.0.0/14 3.8.37.24/29 3.80.0.0/12 3.96.0.0/15 3.98.0.0/15 3.98.24.0/28 3.98.24.16/28 31.220.220.0/22 34.192.0.0/12 34.195.252.0/24 34.208.0.0/12 34.216.51.0/25 34.223.12.224/27 34.223.80.192/26 34.224.0.0/12 34.226.14.0/24 34.240.0.0/13 34.248.0.0/13 35.152.0.0/16 35.152.74.144/28 35.152.74.160/28 35.153.0.0/16 35.154.0.0/16 35.155.0.0/16 35.156.0.0/14 35.158.136.0/24 35.160.0.0/13 35.162.63.192/26 35.167.191.128/26 35.168.0.0/13 35.176.0.0/15 35.178.0.0/15 35.180.0.0/16 35.180.112.80/29 35.181.0.0/16 35.182.0.0/15 35.183.92.176/29 35.50.128.0/24 35.50.129.0/24 35.50.130.0/24 35.50.131.0/24 35.50.132.0/24 35.50.133.0/24 35.50.134.0/24 35.50.135.0/24 35.50.142.0/24 35.50.143.0/24 35.50.144.0/24 35.50.176.0/24 35.50.177.0/24 35.50.178.0/24 35.50.192.0/24 35.50.193.0/24 35.50.194.0/24 35.50.195.0/24 35.50.196.0/24 35.50.197.0/24 35.50.208.0/24 35.50.210.0/24 35.50.211.0/24 35.50.212.0/24 35.50.213.0/24 35.50.214.0/24 35.50.224.0/24 35.50.226.0/24 35.50.227.0/24 35.50.228.0/24 35.50.229.0/24 35.50.230.0/24 35.50.231.0/24 35.50.232.0/24 35.50.233.0/24 35.50.234.0/24 35.50.235.0/24 35.50.236.0/24 35.50.237.0/24 35.50.238.0/24 35.50.239.0/24 35.71.100.0/24 35.71.101.0/24 35.71.102.0/24 35.71.103.0/24 35.71.104.0/24 35.71.105.0/24 35.71.106.0/24 35.71.107.0/24 35.71.108.0/24 35.71.109.0/24 35.71.110.0/24 35.71.111.0/24 35.71.112.0/24 35.71.113.0/24 35.71.114.0/24 35.71.115.0/24 35.71.116.0/24 35.71.117.0/24 35.71.118.0/24 35.71.119.0/24 35.71.120.0/24 35.71.121.0/24 35.71.122.0/24 35.71.123.0/24 35.71.124.0/24 35.71.125.0/24 35.71.126.0/24 35.71.127.0/24 35.71.64.0/22 35.71.68.0/22 35.71.72.0/22 35.71.96.0/24 35.71.97.0/24 35.71.98.0/24 35.71.99.0/24 35.72.0.0/13 35.72.164.240/28 35.73.115.0/28 35.80.0.0/12 35.80.36.208/28 35.80.36.224/28 35.93.168.0/23 35.93.170.0/23 35.93.172.0/23 35.96.0.0/24 35.96.1.0/24 35.96.10.0/24 35.96.11.0/24 35.96.112.0/20 35.96.12.0/24 35.96.128.0/20 35.96.13.0/24 35.96.14.0/24 35.96.144.0/20 35.96.15.0/24 35.96.16.0/20 35.96.2.0/24 35.96.240.0/24 35.96.241.0/24 35.96.242.0/24 35.96.243.0/24 35.96.244.0/24 35.96.245.0/24 35.96.246.0/24 35.96.247.0/24 35.96.248.0/24 35.96.249.0/24 35.96.250.0/24 35.96.251.0/24 35.96.252.0/24 35.96.3.0/24 35.96.32.0/20 35.96.4.0/24 35.96.48.0/20 35.96.5.0/24 35.96.6.0/24 35.96.64.0/20 35.96.7.0/24 35.96.8.0/24 35.96.80.0/20 35.96.9.0/24 35.96.96.0/20 36.103.232.0/25 36.103.232.128/26 40.172.0.0/16 40.176.0.0/15 40.176.101.64/28 40.176.213.168/29 40.176.98.240/28 40.192.0.0/17 43.192.0.0/16 43.192.155.8/29 43.193.0.0/18 43.193.64.0/24 43.196.0.0/16 43.196.20.40/29 43.198.0.0/15 43.198.192.104/29 43.200.0.0/14 43.204.0.0/15 43.206.0.0/15 43.208.0.0/15 43.208.66.128/28 43.208.66.144/28 43.210.0.0/15 43.212.0.0/15 43.216.0.0/15 43.216.87.0/28 43.216.87.16/28 43.216.87.48/29 43.218.0.0/16 43.218.193.112/28 43.218.193.64/29 43.218.193.96/28 43.218.222.160/28 43.218.222.176/28 43.218.56.128/26 43.218.56.192/26 43.218.56.64/26 43.218.71.0/26 43.220.0.0/16 44.192.0.0/11 44.192.134.240/28 44.192.140.64/28 44.220.194.0/23 44.220.196.0/23 44.220.198.0/23 44.220.200.0/23 44.220.202.0/23 44.222.66.0/24 44.224.0.0/11 44.227.178.0/24 44.234.108.128/25 44.234.90.252/30 45.57.128.0/18 46.137.0.0/17 46.137.128.0/18 46.137.192.0/19 46.137.224.0/19 46.51.128.0/18 46.51.192.0/20 46.51.208.0/22 46.51.216.0/21 46.51.224.0/19 47.128.0.0/14 47.129.82.0/24 47.129.83.0/24 47.129.84.0/24 5.174.0.0/16 5.179.96.0/20 50.112.0.0/16 50.16.0.0/15 50.18.0.0/16 50.19.0.0/16 51.0.104.0/21 51.0.112.0/21 51.0.128.0/21 51.0.252.0/24 51.0.29.128/28 51.0.80.0/21 51.0.88.0/21 51.0.96.0/21 51.112.0.0/16 51.112.11.64/28 51.112.11.80/28 51.118.0.0/16 51.16.0.0/15 51.16.183.224/29 51.168.0.0/15 51.17.129.160/28 51.17.129.176/28 51.20.0.0/16 51.21.0.0/16 51.224.0.0/15 51.24.0.0/16 51.34.0.0/16 51.44.0.0/16 51.45.0.0/16 51.48.0.0/15 51.84.0.0/16 51.85.0.0/16 51.92.0.0/16 51.94.0.0/15 51.96.0.0/16 52.0.0.0/15 52.10.0.0/15 52.119.205.0/24 52.12.0.0/15 52.124.128.0/17 52.129.224.0/22 52.14.0.0/16 52.15.0.0/16 52.15.127.128/26 52.16.0.0/15 52.18.0.0/15 52.192.0.0/15 52.194.0.0/15 52.196.0.0/14 52.199.127.192/26 52.2.0.0/15 52.20.0.0/14 52.200.0.0/13 52.208.0.0/13 52.212.248.0/26 52.216.0.0/15 52.218.0.0/17 52.218.128.0/17 52.219.0.0/20 52.219.112.0/21 52.219.120.0/22 52.219.124.0/22 52.219.128.0/22 52.219.132.0/22 52.219.136.0/22 52.219.140.0/24 52.219.141.0/24 52.219.142.0/24 52.219.143.0/24 52.219.144.0/22 52.219.148.0/23 52.219.150.0/23 52.219.152.0/22 52.219.156.0/22 52.219.16.0/22 52.219.160.0/23 52.219.162.0/23 52.219.164.0/22 52.219.168.0/24 52.219.169.0/24 52.219.170.0/23 52.219.172.0/22 52.219.176.0/22 52.219.180.0/22 52.219.184.0/21 52.219.192.0/23 52.219.194.0/24 52.219.195.0/24 52.219.196.0/22 52.219.20.0/24 52.219.200.0/24 52.219.201.0/24 52.219.202.0/23 52.219.204.0/22 52.219.208.0/23 52.219.210.0/24 52.219.211.0/24 52.219.212.0/22 52.219.216.0/23 52.219.218.0/24 52.219.219.0/24 52.219.220.0/23 52.219.224.0/22 52.219.228.0/22 52.219.232.0/22 52.219.24.0/21 52.219.254.0/24 52.219.255.0/24 52.219.32.0/21 52.219.40.0/22 52.219.44.0/22 52.219.56.0/22 52.219.60.0/23 52.219.62.0/23 52.219.64.0/22 52.219.68.0/22 52.219.72.0/22 52.219.80.0/20 52.219.96.0/20 52.220.0.0/15 52.220.191.0/26 52.222.0.0/17 52.222.128.0/17 52.24.0.0/14 52.28.0.0/16 52.29.0.0/16 52.30.0.0/15 52.32.0.0/14 52.36.0.0/14 52.4.0.0/14 52.40.0.0/14 52.44.0.0/15 52.46.0.0/18 52.46.0.0/22 52.46.16.0/20 52.46.180.0/22 52.46.184.0/22 52.46.32.0/19 52.46.4.0/23 52.47.0.0/16 52.47.139.0/24 52.48.0.0/14 52.52.0.0/15 52.52.191.128/26 52.54.0.0/15 52.56.0.0/16 52.56.127.0/25 52.57.0.0/16 52.57.254.0/24 52.58.0.0/15 52.60.0.0/16 52.61.0.0/16 52.62.0.0/15 52.64.0.0/17 52.64.128.0/17 52.65.0.0/16 52.66.0.0/16 52.66.194.128/26 52.67.0.0/16 52.68.0.0/15 52.70.0.0/15 52.72.0.0/15 52.74.0.0/16 52.75.0.0/16 52.76.0.0/17 52.76.128.0/17 52.77.0.0/16 52.78.0.0/16 52.78.247.128/26 52.79.0.0/16 52.8.0.0/16 52.80.0.0/16 52.81.0.0/16 52.82.0.0/17 52.82.128.0/19 52.82.128.0/23 52.82.134.0/23 52.82.164.0/22 52.82.168.0/24 52.82.169.0/28 52.82.170.0/24 52.82.176.0/22 52.82.180.0/22 52.82.184.0/23 52.82.188.0/22 52.83.0.0/16 52.84.0.0/15 52.86.0.0/15 52.88.0.0/15 52.9.0.0/16 52.90.0.0/15 52.92.0.0/17 52.92.128.0/17 52.94.116.0/22 52.94.144.0/23 52.94.146.0/24 52.94.201.0/26 52.94.248.0/28 52.94.248.112/28 52.94.248.128/28 52.94.248.144/28 52.94.248.16/28 52.94.248.160/28 52.94.248.176/28 52.94.248.192/28 52.94.248.208/28 52.94.248.224/28 52.94.248.32/28 52.94.248.48/28 52.94.248.64/28 52.94.248.80/28 52.94.248.96/28 52.94.249.112/28 52.94.249.128/28 52.94.249.144/28 52.94.249.160/28 52.94.249.176/28 52.94.249.192/28 52.94.249.208/28 52.94.249.224/28 52.94.249.240/28 52.94.249.32/28 52.94.249.48/28 52.94.249.64/28 52.94.249.80/28 52.94.249.96/28 52.94.250.0/28 52.94.250.112/28 52.94.250.128/28 52.94.250.144/28 52.94.250.16/28 52.94.250.160/28 52.94.250.32/28 52.94.250.48/28 52.94.250.80/28 52.94.250.96/28 52.95.128.0/21 52.95.136.0/23 52.95.138.0/24 52.95.139.0/24 52.95.140.0/23 52.95.142.0/23 52.95.144.0/24 52.95.145.0/24 52.95.146.0/23 52.95.148.0/23 52.95.150.0/24 52.95.151.0/24 52.95.152.0/23 52.95.154.0/23 52.95.156.0/24 52.95.157.0/24 52.95.158.0/23 52.95.160.0/23 52.95.162.0/24 52.95.163.0/24 52.95.164.0/23 52.95.166.0/23 52.95.168.0/24 52.95.169.0/24 52.95.170.0/23 52.95.172.0/23 52.95.174.0/24 52.95.175.0/24 52.95.176.0/24 52.95.177.0/24 52.95.178.0/23 52.95.180.0/24 52.95.181.0/24 52.95.182.0/23 52.95.184.0/23 52.95.186.0/24 52.95.187.0/24 52.95.188.0/23 52.95.190.0/24 52.95.191.0/24 52.95.224.0/24 52.95.225.0/24 52.95.226.0/24 52.95.227.0/24 52.95.228.0/24 52.95.229.0/24 52.95.230.0/24 52.95.235.0/24 52.95.239.0/24 52.95.240.0/24 52.95.241.0/24 52.95.242.0/24 52.95.243.0/24 52.95.244.0/24 52.95.245.0/24 52.95.246.0/24 52.95.247.0/24 52.95.248.0/24 52.95.249.0/24 52.95.250.0/24 52.95.251.0/24 52.95.252.0/24 52.95.253.0/24 52.95.254.0/24 52.95.255.0/28 52.95.255.112/28 52.95.255.128/28 52.95.255.144/28 52.95.255.16/28 52.95.255.32/28 52.95.255.48/28 52.95.255.64/28 52.95.255.80/28 52.95.255.96/28 54.112.0.0/18 54.116.0.0/15 54.144.0.0/14 54.148.0.0/15 54.150.0.0/16 54.151.0.0/17 54.151.128.0/17 54.152.0.0/16 54.153.0.0/17 54.153.128.0/17 54.154.0.0/16 54.155.0.0/16 54.156.0.0/14 54.160.0.0/13 54.168.0.0/16 54.169.0.0/16 54.170.0.0/15 54.172.0.0/15 54.174.0.0/15 54.176.0.0/15 54.178.0.0/16 54.179.0.0/16 54.180.0.0/15 54.182.0.0/16 54.182.128.0/20 54.182.144.0/21 54.182.154.0/23 54.182.156.0/22 54.182.160.0/21 54.182.172.0/22 54.182.176.0/21 54.182.184.0/22 54.182.188.0/23 54.182.224.0/21 54.182.240.0/21 54.182.248.0/22 54.183.0.0/16 54.184.0.0/13 54.192.0.0/16 54.193.0.0/16 54.194.0.0/15 54.196.0.0/15 54.198.0.0/16 54.199.0.0/16 54.200.0.0/15 54.202.0.0/15 54.204.0.0/15 54.206.0.0/16 54.207.0.0/16 54.208.0.0/15 54.210.0.0/15 54.212.0.0/15 54.214.0.0/16 54.215.0.0/16 54.216.0.0/15 54.218.0.0/16 54.219.0.0/16 54.220.0.0/16 54.221.0.0/16 54.222.100.0/22 54.222.112.0/20 54.222.128.0/17 54.222.32.0/22 54.222.36.0/22 54.222.48.0/22 54.222.52.0/22 54.222.58.32/28 54.222.64.0/24 54.222.88.0/24 54.222.89.0/24 54.222.96.0/22 54.223.0.0/16 54.224.0.0/15 54.226.0.0/15 54.228.0.0/16 54.229.0.0/16 54.230.0.0/17 54.230.128.0/18 54.230.200.0/21 54.230.208.0/20 54.230.224.0/19 54.231.0.0/16 54.232.0.0/16 54.233.0.0/18 54.233.128.0/17 54.233.255.128/26 54.233.64.0/18 54.234.0.0/15 54.236.0.0/15 54.238.0.0/16 54.239.103.128/26 54.239.128.0/18 54.239.134.0/23 54.239.170.0/23 54.239.192.0/19 54.239.204.0/22 54.239.208.0/21 54.240.128.0/18 54.241.0.0/16 54.242.0.0/15 54.244.0.0/16 54.245.0.0/16 54.246.0.0/16 54.247.0.0/16 54.248.0.0/15 54.25.14.0/24 54.25.15.0/24 54.25.20.0/24 54.25.82.0/24 54.250.0.0/16 54.251.0.0/16 54.252.0.0/16 54.253.0.0/16 54.254.0.0/16 54.255.0.0/16 54.26.166.0/24 54.46.0.0/17 54.64.0.0/15 54.66.0.0/16 54.67.0.0/16 54.68.0.0/14 54.72.0.0/15 54.74.0.0/15 54.76.0.0/15 54.78.0.0/16 54.79.0.0/16 54.80.0.0/13 54.88.0.0/14 54.92.0.0/17 54.92.128.0/17 54.93.0.0/16 54.94.0.0/16 54.95.0.0/16 56.112.0.0/16 56.124.0.0/17 56.125.0.0/16 56.125.46.0/24 56.125.47.0/32 56.125.48.0/24 56.126.0.0/16 56.136.0.0/16 56.137.0.0/16 56.155.0.0/17 56.155.128.0/17 56.228.0.0/16 56.68.0.0/17 56.69.0.0/16 57.180.0.0/14 58.254.138.0/25 58.254.138.128/26 63.176.0.0/14 63.180.0.0/14 63.246.112.0/24 63.246.113.0/24 63.246.119.0/24 63.32.0.0/14 64.187.128.0/20 64.252.100.0/24 64.252.101.0/24 64.252.102.0/24 64.252.103.0/24 64.252.104.0/24 64.252.105.0/24 64.252.106.0/24 64.252.107.0/24 64.252.108.0/24 64.252.109.0/24 64.252.110.0/24 64.252.111.0/24 64.252.112.0/24 64.252.113.0/24 64.252.114.0/24 64.252.115.0/24 64.252.116.0/24 64.252.117.0/24 64.252.118.0/24 64.252.119.0/24 64.252.120.0/24 64.252.121.0/24 64.252.122.0/24 64.252.123.0/24 64.252.124.0/24 64.252.125.0/24 64.252.128.0/18 64.252.64.0/18 64.252.64.0/24 64.252.65.0/24 64.252.66.0/24 64.252.67.0/24 64.252.68.0/24 64.252.69.0/24 64.252.70.0/24 64.252.71.0/24 64.252.72.0/24 64.252.73.0/24 64.252.74.0/24 64.252.75.0/24 64.252.76.0/24 64.252.77.0/24 64.252.78.0/24 64.252.79.0/24 64.252.80.0/24 64.252.81.0/24 64.252.82.0/24 64.252.83.0/24 64.252.84.0/24 64.252.85.0/24 64.252.86.0/24 64.252.87.0/24 64.252.88.0/24 64.252.89.0/24 64.252.97.0/24 64.252.98.0/24 64.252.99.0/24 65.0.0.0/14 65.1.103.208/28 65.1.103.224/28 65.8.0.0/16 65.9.0.0/17 65.9.128.0/18 67.202.0.0/18 68.66.112.0/20 68.79.0.0/18 68.79.2.192/28 68.79.2.224/28 69.230.192.0/18 69.231.128.0/18 69.234.192.0/18 69.234.250.64/28 69.234.250.80/28 69.235.128.0/18 70.132.0.0/18 70.224.192.0/18 70.232.124.0/22 70.232.86.124/32 70.232.86.125/32 70.232.86.126/32 70.232.92.0/22 71.131.192.0/18 71.131.196.224/28 71.131.196.240/28 71.132.0.0/18 71.136.64.0/18 71.137.0.0/18 71.152.0.0/17 72.41.0.0/20 72.44.32.0/19 75.101.128.0/17 75.2.128.0/18 75.3.0.0/18 75.3.128.0/18 75.45.128.0/18 76.223.100.0/24 76.223.101.0/24 76.223.102.0/24 76.223.103.0/24 76.223.104.0/24 76.223.95.0/24 76.223.96.0/24 76.223.97.0/24 76.223.98.0/24 76.223.99.0/24 78.12.0.0/15 78.12.79.192/28 78.12.79.208/28 78.14.0.0/15 79.125.0.0/17 83.118.240.0/21 83.118.240.0/22 83.119.128.0/18 83.119.64.0/18 95.40.0.0/15 96.0.0.0/21 96.0.100.0/23 96.0.102.0/23 96.0.104.0/22 96.0.108.0/24 96.0.110.0/23 96.0.112.0/21 96.0.12.0/22 96.0.120.0/21 96.0.128.0/23 96.0.130.0/24 96.0.131.0/24 96.0.132.0/22 96.0.136.0/21 96.0.144.0/21 96.0.152.0/21 96.0.16.0/21 96.0.160.0/20 96.0.24.0/21 96.0.32.0/22 96.0.36.0/22 96.0.40.0/21 96.0.48.0/21 96.0.56.0/22 96.0.60.0/22 96.0.64.0/21 96.0.72.0/21 96.0.8.0/22 96.0.80.0/22 96.0.84.0/22 96.0.88.0/22 96.0.92.0/23 96.0.94.0/23 96.0.96.0/22 96.127.0.0/17 98.130.0.0/16 98.80.0.0/13 98.88.0.0/13 99.150.0.0/21 99.150.104.0/21 99.150.112.0/21 99.150.120.0/21 99.150.16.0/21 99.150.24.0/21 99.150.32.0/21 99.150.40.0/21 99.150.48.0/21 99.150.56.0/21 99.150.64.0/21 99.150.72.0/21 99.150.8.0/21 99.150.80.0/21 99.150.88.0/21 99.150.96.0/21 99.151.104.0/21 99.151.112.0/21 99.151.120.0/21 99.151.128.0/21 99.151.136.0/21 99.151.144.0/21 99.151.152.0/21 99.151.160.0/21 99.151.168.0/21 99.151.184.0/23 99.151.186.0/23 99.151.188.0/23 99.151.190.0/23 99.151.64.0/21 99.151.72.0/21 99.151.80.0/21 99.151.88.0/21 99.151.96.0/21 99.77.128.0/24 99.77.129.0/24 99.77.130.0/24 99.77.131.0/24 99.77.132.0/24 99.77.133.0/24 99.77.134.0/24 99.77.135.0/24 99.77.136.0/24 99.77.137.0/24 99.77.138.0/24 99.77.139.0/24 99.77.140.0/24 99.77.141.0/24 99.77.142.0/24 99.77.143.0/24 99.77.144.0/24 99.77.145.0/24 99.77.147.0/24 99.77.148.0/24 99.77.149.0/24 99.77.150.0/24 99.77.151.0/24 99.77.152.0/24 99.77.153.0/24 99.77.154.0/24 99.77.155.0/24 99.77.156.0/24 99.77.157.0/24 99.77.158.0/24 99.77.159.0/24 99.77.160.0/24 99.77.161.0/24 99.77.162.0/24 99.77.163.0/24 99.77.183.0/24 99.77.184.0/24 99.77.186.0/24 99.77.187.0/24 99.77.191.0/24 99.77.232.0/24 99.77.233.0/24 99.77.234.0/24 99.77.235.0/24 99.77.236.0/24 99.77.237.0/24 99.77.238.0/24 99.77.239.0/24 99.77.240.0/24 99.77.241.0/24 99.77.242.0/24 99.77.243.0/24 99.77.244.0/24 99.77.245.0/24 99.77.246.0/24 99.77.247.0/24 99.77.248.0/24 99.77.249.0/24 99.77.250.0/24 99.77.251.0/24 99.77.252.0/24 99.77.253.0/24 99.77.254.0/24 99.77.55.0/32 99.77.55.1/32 99.77.55.12/32 99.77.55.13/32 99.77.55.14/32 99.77.55.15/32 99.77.55.2/32 99.77.55.24/32 99.77.55.25/32 99.77.55.253/32 99.77.55.254/32 99.77.55.255/32 99.77.55.26/32 99.77.55.27/32 99.77.55.3/32 99.77.55.32/32 99.77.55.33/32 99.77.55.34/32 99.77.55.35/32 99.77.55.36/32 99.77.55.37/32 99.77.55.38/32 99.77.55.39/32 99.77.55.40/32 99.77.55.41/32 99.77.55.42/32 99.77.55.43/32 99.77.55.44/32 99.77.55.45/32 99.77.55.46/32 99.77.55.47/32 99.77.55.49/32 99.77.55.50/32 99.77.55.51/32 99.77.55.52/32 99.77.55.53/32 99.77.55.54/32 99.77.55.55/32 99.77.55.56/32 99.78.238.251/32 99.78.238.253/32 99.78.238.255/32 99.79.0.0/16 99.79.169.0/24 99.80.0.0/15 99.84.0.0/16 99.86.0.0/16 " # Add more Amazon ranges as needed
)

# Update CIDR ranges if -u option is used
if [[ "$update_cidr" == "true" ]]; then
    update_cidr_ranges
fi

# Function to process a single domain
process_domain() {
    local domain="$1"
    local ip_addresses
    ip_addresses=$(resolve_to_ip "$domain")

    for ip in $ip_addresses; do
        for provider in "${!providers[@]}"; do
            for cidr in ${providers[$provider]}; do
                if ip_in_cidr "$ip" "$cidr"; then
                    echo -e "$domain\t$ip" >>"$output_file"
                    return
                fi
            done
        done
    done
}

# Process domains sequentially
while IFS= read -r domain; do
    # Skip empty lines and comments
    [[ -z "$domain" || "$domain" =~ ^# ]] && continue
    process_domain "$domain"
done <"$source_file"

# Sort and remove duplicates in the output file
sort -u "$output_file" -o "$output_file"

echo "Filtered domains have been written to $output_file"
